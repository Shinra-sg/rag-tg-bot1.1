# Управление администраторами

## Обзор

Добавлена возможность управления администраторами бота через username вместо ID. Это позволяет добавлять админов, даже если они еще не заходили в бота.

## Функциональность

### 1. Добавление админа
- **Команда**: "Добавить админа"
- **Формат**: `@username` или `username`
- **Описание**: Добавляет нового администратора по username
- **Особенности**: 
  - Автоматически убирает символ `@` если он есть
  - Проверяет на дубликаты
  - `user_id` устанавливается в `null` до первого входа в бота

### 2. Удаление админа
- **Команда**: "Удалить админа"
- **Формат**: `@username` или `username`
- **Описание**: Удаляет администратора по username
- **Особенности**: Показывает список текущих админов перед удалением

### 3. Просмотр списка админов
- **Команда**: "Список админов"
- **Описание**: Показывает всех администраторов с информацией:
  - Username
  - User ID (или "не заходил в бота")
  - Дата добавления

## Структура базы данных

### Таблица `admins`
```sql
CREATE TABLE admins (
    id SERIAL PRIMARY KEY,
    username VARCHAR(255) UNIQUE NOT NULL,
    user_id BIGINT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## Установка

1. Создать таблицу в базе данных:
```bash
npm run setup:admins
```

2. Протестировать функциональность:
```bash
npm run test:admins
```

## Использование

1. Запустить админ-бота:
```bash
npm run start:admin
```

2. В главном меню выбрать "Управление админами"

3. Использовать доступные команды:
   - "Добавить админа"
   - "Удалить админа" 
   - "Список админов"

## Обратная совместимость

- Старая система проверки по ID в `admin_ids.json` продолжает работать
- Новые админы добавляются в базу данных
- При первом входе админа в бота его `user_id` автоматически обновляется

## Логирование

Все действия с админами логируются в таблицу `admin_logs`:
- Добавление админа
- Удаление админа
- Просмотр списка админов

## Безопасность

- Только существующие админы могут управлять другими админами
- Проверка на дубликаты при добавлении
- Валидация username (не может быть пустым) 